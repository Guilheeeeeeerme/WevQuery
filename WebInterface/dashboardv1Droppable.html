<!DOCTYPE HTML>
<html>
<link rel="stylesheet" href="style.css">
<link rel="stylesheet" href="./jquery-ui-1.12.1/jquery-ui.min.css">
<script src="./jquery-ui-1.12.1/external/jquery/jquery.js"></script>
<script src="./jquery-ui-1.12.1/jquery-ui.min.js"></script>

<head>
  <title>User log query abstraction language</title>

  <script>

  $( function() {
     var $eventPaletteArea = $( "#eventPaletteArea" ),
      $eventOrderArea = $( "#eventOrderArea" );

      $( ".eventTemplate" ).draggable({
          handle: "img.handle", //The template will only be draggable using the anchor
          revert: "invalid", // when not dropped, the item will revert back to its initial position
          helper: "clone",//a clone of the template will appear when dragged
          cursor: "move",//when dragged the cursor changes.
          refreshPositions: true //If set to true, all droppable positions are calculated on every mousemove. 
        });

      $eventOrderArea.droppable({
        //activeClass: ".eventTemplate",
        //hoverClass: ".eventTemplate",
        accept: ".eventTemplate",//what elements can be dropped here
        drop: function( event, ui ) {//what to do when an element is dropped here
              var i=0; //used as flag to find out if element added or not
              $(this).children('li').each(function()
              {
                  if($(this).offset().left>=ui.offset.left)  //compare
                {
                    ui.draggable.insertBefore($(this));
                    i=1;   
                    return false; //break loop
                }
              })

              if(i!=1) //if element dropped at the end
              {
                  ui.draggable.appendTo(this);
              } 
        }
      });

      $eventOrderArea.sortable({
        items: "li",
        sort: function () {
             // gets added unintentionally by droppable interacting with sortable
             // using connectWithSortable fixes this, but doesn't allow you to customize active/hoverClass options
             $(this).removeClass("ui-state-default");
         }
      });

      $eventPaletteArea.sortable().disableSelection();
      $eventPaletteArea.droppable({
        accept: ".eventTemplate",//what elements can be dropped here
        drop: function( event, ui ) {//what to do when an element is dropped here
        addTemplateToPaletteArea( ui.draggable );
      }
      });
   
    function addTemplateToOrderArea( $item ) {
      $item.fadeOut(function() {
         $item.appendTo( $eventOrderArea ).fadeIn();
      });
    }

    function addTemplateToPaletteArea( $item ) {
      $item.fadeOut(function() {
         $item.appendTo( $eventPaletteArea ).fadeIn();
      });
    }

  });

  </script>

</head>

<body>
  <h1> Interaction Dashboard </h1>
  <h2> Event Palette </h2>
  <ul id="eventPaletteArea">
    <li id="exampleEventTemplate" class="eventTemplate">
      <p id="title"> Event 1</p>
      <img class="handle" src="./res/drag.png" />
      <p> Events:</p>
      <p>mouseover,mouseout</p>
      <p> Occurrence:</p>
      <p> Context</p>
      <p> ndoeID:"submit"</p>
    </li>
    <li id="exampleEventTemplate" class="eventTemplate">
      <p id="title"> Event 2</p>
      <img class="handle" src="./res/drag.png" />
      <p id="title"> Event 2</p>
      <p>mouseover,mouseout</p>
      <p> Occurrence:</p>
      <p> Context</p>
      <p> ndoeID:"submit"</p>
    </li>
    <li id="exampleEventTemplate" class="eventTemplate">
      <p id="title"> Event 3</p>
      <img class="handle" src="./res/drag.png" />
      <p id="title"> Event 2</p>
      <p>mouseover,mouseout</p>
      <p> Occurrence:</p>
      <p> Context</p>
      <p> ndoeID:"submit"</p>
    </li>
  </ul>

  <h2> Event Order Area </h2>
  <ul id="eventOrderArea">
    <li id="exampleEventTemplate" class="eventTemplate">
      <p id="title"> Event 4</p>
      <img class="handle" src="./res/drag.png" />
      <p> Events:</p>
      <p>mouseover,mouseout</p>
      <p> Occurrence:</p>
      <p> Context</p>
      <p> ndoeID:"submit"</p>
    </li>
    <li id="exampleEventTemplate" class="eventTemplate">
      <p id="title"> event 5</p>
      <img class="handle" src="./res/drag.png" />
      <p id="title"> Event 2</p>
      <p>mouseover,mouseout</p>
      <p> Occurrence:</p>
      <p> Context</p>
      <p> ndoeID:"submit"</p>
    </li>
    <li id="exampleEventTemplate" class="eventTemplate">
      <p id="title"> Event 6</p>
      <img class="handle" src="./res/drag.png" />
      <p id="title"> Event 2</p>
      <p>mouseover,mouseout</p>
      <p> Occurrence:</p>
      <p> Context</p>
      <p> ndoeID:"submit"</p>
    </li>
  </ul>

</body>

</html>